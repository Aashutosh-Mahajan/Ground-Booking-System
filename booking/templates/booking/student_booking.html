{% extends 'base.html' %}
{% block title %}Book Ground{% endblock %}
{% block content %}
<div class="max-w-4xl mx-auto py-12 px-4">
    <div class="card">
        <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Book a Ground</h2>

        <form method="POST" action="{% url 'student-booking' %}" class="space-y-6">
            {% csrf_token %}
            
            <!-- Student Information -->
            <div class="grid grid-cols-2 gap-6">
                <div class="form-group">
                    <label for="id_student_name" class="form-label">Full Name</label>
                    {{ booking_form.student_name }}
                </div>
                <div class="form-group">
                    <label for="id_roll_number" class="form-label">Roll Number</label>
                    {{ booking_form.roll_number }}
                </div>
            </div>

            <!-- Ground and Date Selection -->
            <div class="grid grid-cols-2 gap-6">
                <div class="form-group">
                    <label for="id_ground" class="form-label">Ground Selection</label>
                    {{ booking_form.ground }}
                </div>
                <div class="form-group">
                    <label for="id_date" class="form-label">Date</label>
                    {{ booking_form.date }}
                </div>
            </div>

            <!-- Time Slot and Number of Players -->
            <div class="grid grid-cols-2 gap-6">
                <div class="form-group">
                    <label for="id_time_slot" class="form-label">Time Slot</label>
                    {{ booking_form.time_slot }}
                </div>
                <div class="form-group">
                    <label for="id_number_of_players" class="form-label">Number of Players</label>
                    {{ booking_form.number_of_players }}
                </div>
            </div>

            <!-- Purpose -->
            <div class="form-group">
                <label for="id_purpose" class="form-label">Purpose</label>
                {{ booking_form.purpose }}
            </div>

            <!-- Player Information (Dynamic) -->
            <div id="players-container" class="space-y-4">
                <!-- Player forms will be generated here -->
            </div>

            <button type="submit" class="btn btn-primary btn-full">
                Submit Booking Request
            </button>
        </form>

        {% if success %}
            <div class="mt-6 text-green-600 text-center font-semibold">
                {{ success }}
            </div>
        {% endif %}
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const numPlayersSelect = document.getElementById('id_number_of_players');
    const playersContainer = document.getElementById('players-container');

    function generatePlayerForms(count) {
        playersContainer.innerHTML = '';
        
        for (let i = 1; i <= count; i++) {
            const playerForm = document.createElement('div');
            playerForm.className = 'player-form';
            playerForm.innerHTML = `
                <h3 class="text-lg font-semibold mb-4">Player ${i}</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="form-group">
                        <label class="form-label">Name</label>
                        <input type="text" name="player${i}_name" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Branch</label>
                        <select name="player${i}_branch" class="form-select" required>
                            <option value="">Select Branch</option>
                            <option value="CSE">CSE</option>
                            <option value="IT">IT</option>
                            <option value="EXCS">EXCS</option>
                            <option value="EXTC">EXTC</option>
                            <option value="BIOM">BIOM</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Year</label>
                        <select name="player${i}_year" class="form-select" required>
                            <option value="">Select Year</option>
                            <option value="FE">FE</option>
                            <option value="SE">SE</option>
                            <option value="TE">TE</option>
                            <option value="BE">BE</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Division</label>
                        <input type="text" name="player${i}_division" class="form-input" required>
                    </div>
                </div>
            `;
            playersContainer.appendChild(playerForm);
        }
    }

    // Generate initial player forms
    if (numPlayersSelect.value) {
        generatePlayerForms(parseInt(numPlayersSelect.value));
    }

    // Update player forms when selection changes
    numPlayersSelect.addEventListener('change', function() {
        const count = parseInt(this.value) || 0;
        generatePlayerForms(count);
    });
});
</script>
{% endblock %}
